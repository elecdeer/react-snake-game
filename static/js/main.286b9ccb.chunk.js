(this["webpackJsonpreact-snake-game"]=this["webpackJsonpreact-snake-game"]||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(5),o=n.n(r),l=(n(14),n(1)),u=(n(15),n(2)),i=function(e){e.index;var t=e.type,n=Object(u.d)(j),a=Object(u.d)(x),r=c.a.createElement(c.a.Fragment,null);if(t===v.SnakeHead){var o={transform:"rotate(".concat(function(e){switch(n){case O.Top:return-90;case O.Bottom:return 90;case O.Right:return 0;case O.Left:return 180}}(),"deg)")},l="\uff1a";"GameOver"===a&&(l="X"),r=c.a.createElement("div",{className:"snake-eye",style:o},l)}return c.a.createElement("div",{className:"square"},c.a.createElement("div",{className:t+" square-inner"},r))},s=function(){for(var e,t=Object(u.d)(h),n=[],a=0;a<m;a++){for(var r=[],o=0;o<f;o++){var l=a*f+o;r.push((e=l,c.a.createElement(i,{index:e,key:e,type:t[e]})))}n.push(c.a.createElement("div",{className:"board-row",key:a},r))}return c.a.createElement("div",null,n)},d=n(19),f=12,m=12,b=function(e,t){return t*f+e},y=function(e){return e.y*f+e.x},v={Empty:"empty",SnakeHead:"snake-head",SnakeBody:"snake-body",Feed:"feed",Wall:"wall"},O={Top:{dx:0,dy:-1,text:"\u2191"},Bottom:{dx:0,dy:1,text:"\u2193"},Right:{dx:1,dy:0,text:"\u2192"},Left:{dx:-1,dy:0,text:"\u2190"}},j=Object(u.b)({key:"snakeFacing",default:O.Top}),E=function(){for(var e=f*m,t=new Array(e).fill(v.Empty),n=0;n<t.length;n++)(n<f||e-f<n||n%m===0||n%m===f-1)&&(t[n]=v.Wall);return t}(),h=Object(u.b)({key:"boardState",default:E}),k=Object(u.b)({key:"lengthState",default:4}),g=Object(u.b)({key:"snakeBodyState",default:[{x:Math.round(f/2),y:Math.round(m/2)}]}),p=Object(u.b)({key:"feedPosState",default:{x:1,y:1}}),x=Object(u.b)({key:"gameState",default:"WaitStart"});var S=function(){var e=Object(u.c)(j),t=Object(l.a)(e,2),n=t[0],r=t[1],o=Object(u.c)(k),i=Object(l.a)(o,2),S=i[0],w=i[1],B=Object(u.c)(g),W=Object(l.a)(B,2),M=W[0],N=W[1],F=M[0],G=Object(u.c)(p),P=Object(l.a)(G,2),R=P[0],T=P[1],A=Object(u.c)(h),C=Object(l.a)(A,2),H=C[0],I=C[1],L=Object(u.c)(x),q=Object(l.a)(L,2),J=q[0],D=q[1],X=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},$=function(){for(;;){var e=X(1,f-2),t=X(1,m-2);console.log("try",e,t);var n=b(e,t);if(console.log(H[n]),H[n]===v.Empty){T({x:e,y:t});break}}},z=function(e){0!==n.dx&&n.dx===-e.dx||0!==n.dy&&n.dy===-e.dy||r(e)};Object(a.useEffect)((function(){I((function(e){var t=E.slice();return M.slice(1).forEach((function(e){t[y(e)]=v.SnakeBody})),t[y(M[0])]=v.SnakeHead,t[y(R)]=v.Feed,t}))}),[R,F,M,I]),Object(d.a)("s",(function(){z(O.Bottom)}),{},[F]),Object(d.a)("w",(function(){z(O.Top)}),{},[F]),Object(d.a)("a",(function(){z(O.Left)}),{},[F]),Object(d.a)("d",(function(){z(O.Right)}),{},[F]);var K=function(e,t){var n=Object(a.useState)(t),c=Object(l.a)(n,2),r=c[0],o=c[1],u=Object(a.useRef)((function(){}));return Object(a.useEffect)((function(){u.current=e})),Object(a.useEffect)((function(){var e=setInterval((function(){return u.current()}),r);return function(){return clearInterval(e)}}),[r]),o}((function(){console.log("update",J),"Playing"===J&&function(){var e=F.x+n.dx,t=F.y+n.dy,a=H[b(e,t)];if(function(){if(a===v.Wall)return!0;var n=M[M.length-1];return a===v.SnakeBody&&(n.x!==e||n.y!==t)}())return console.log("gameover"),void D("GameOver");a===v.Feed&&(w((function(e){return e+1})),$());var c=[{x:e,y:t}].concat(M).slice(0,S);N(c),console.log(c)}()}),1e3);Object(a.useEffect)((function(){K(1e3-30*S)}),[S,K]),Object(d.a)(" ",(function(){console.log(F),console.log(H)}),{},[F,H]);var Q=function(){D("Playing"),Z()},U=Object(u.e)(h),V=Object(u.e)(k),Y=Object(u.e)(g),Z=function(){U(),V(),Y(),$()};return c.a.createElement("div",{className:"App"},c.a.createElement("h2",null,"Snake Game"),c.a.createElement("p",null,"WASD\u3067\u64cd\u4f5c"),function(){switch(J){case"WaitStart":return c.a.createElement("div",null,c.a.createElement("p",null,"Push to Start"),c.a.createElement("button",{onClick:Q},"Start"));case"Playing":return c.a.createElement("div",null,c.a.createElement("p",null,"Score:",S),c.a.createElement("button",{onClick:Q,disabled:!0},"Start"));case"GameOver":return c.a.createElement("div",null,c.a.createElement("p",null,"GameOver Score:",S),c.a.createElement("button",{onClick:Q},"Restart"))}}(),c.a.createElement("div",{className:"game-board"},c.a.createElement(s,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(u.a,null,c.a.createElement(S,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.286b9ccb.chunk.js.map